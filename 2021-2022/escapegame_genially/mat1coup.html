<div id="container" style="width: 100%; height: 100%;">
</div>
<div id="overlay" style="width: 100%; height: 100%; background-color: #00000080; z-index: 9999999; display: none; position: absolute; top: 0; left: 0;">
</div>

<style>
    #chessboard tr td, #chessboard tr th {
        padding: 0;
        margin: 0;
    }

    #chessboard tr th{
        vertical-align: middle;
        font-weight: normal;
    }

    #chessboard div.takeAllPlace {
        width: 100%;
        height: 100%;
        float: left;
    }

    #chessboard div.centerMe {
        position: relative;
        top: 50%;
        transform: translate(0, -50%);
    }
</style>

<script>

    

    class Mat1Coup {
        static BLACK_CELL = "#AAAAAA";
        static WHITE_CELL = "#FFFFFF";
        static BLACK_CELL_HOVER = "#222255";
        static WHITE_CELL_HOVER = "#AAAAFF";
        static INFOS_CELL = "#DDDDDD";

        static WHITE_PIECES = { "K": "&#9812;", "Q": "&#9813;", "R": "&#9814;", "B": "&#9815;", "N": "&#9816;", "P": "&#9817;" };
        static BLACK_PIECES = { "K": "&#9818;", "Q": "&#9819;", "R": "&#9820;", "B": "&#9821;", "N": "&#9822;", "P": "&#9823;" };

        constructor(elementID){
            let container = document.getElementById(elementID);
            let cellSize = Math.floor( Math.min( container.clientHeight, container.clientWidth ) / 9 );

            this.createGrid( elementID, cellSize );

            this.selectCell = null;
        }

        createGrid(elementID, cellSize){

            let halfCellSize = Math.floor( cellSize / 2);
            let table = document.createElement("table")
            
            table.style.cssText = "border-collapse: collapse; text-align: center;";
            table.id = "chessboard";


            this.crearteGridLetter(table, cellSize);

            for( let y = 1; y < 9; ++y ){
                let tr = document.createElement("tr");

                for( let x = 0; x < 10; ++x ){

                    let td = document.createElement("td");

                    if( x == 0 || x == 9 ){
                        td.style.cssText = `width: ${halfCellSize}px; height: ${cellSize}px; border: 1px solid black; background-color: ${Mat1Coup.INFOS_CELL}"`;
                        td.innerHTML = `<div class="takeAllPlace"><div class="centerMe">${y}</div></div>`;
                    }
                    else{
                        td.style.cssText = `cursor: pointer; width: ${cellSize}px; height: ${cellSize}px; border: 1px solid black; background-color: ${ ((x+y) % 2 == 0) ? Mat1Coup.WHITE_CELL : Mat1Coup.BLACK_CELL};`;
                        td.id = `${this.columnIndexToChar(x-1)}${y}`;
                        td.addEventListener("click", (e) => this.onClickCell(td, x, y) );
                    }

                    tr.append(td);
                }

                table.append(tr);
            }

            this.crearteGridLetter(table, cellSize);


            document.getElementById(elementID).innerHTML = "";
            document.getElementById(elementID).append(table);
        }

        crearteGridLetter(table, cellSize){
            let tr = document.createElement("tr");
            let halfCellSize = Math.floor( cellSize / 2);

            for( let i = 0; i < 10; ++i ){
                let td = document.createElement("th");

                if( i == 0 || i == 9 ) {
                    td.style.cssText = `"width: ${halfCellSize}px; height: ${halfCellSize}px;"`;
                }
                else {
                    td.style.cssText = `width: ${cellSize}px; height: ${halfCellSize}px; border: 1px solid black; background-color: ${Mat1Coup.INFOS_CELL}"`;
                    td.innerText = this.columnIndexToChar(i-1);
                }

                tr.append(td);
            }

            table.append(tr);
        }

        columnIndexToChar(index){
            return String.fromCharCode( "A".charCodeAt(0) + index );
        }

        onClickCell(element, x, y){

            if( this.selectCell == null ){
                this.selectCell = element;
                this.applySelectStyle();
            }
            else if( this.selectCell.id == element.id ){
                this.removeSelectStyle();
                this.selectCell = null;
            }
            else{
                console.warn("TODO: compare result");

                this.removeSelectStyle();
                this.selectCell = null;
            }
        }

        applySelectStyle(){
            let div = document.createElement("div");
            div.classList.add("takeAllPlace");
            div.style.background = "radial-gradient(circle, rgba(255,255,255,0) 40%, rgba(50, 50, 255, 1) 100%)";
            // div.style.cssText = `width: 100%; height: 100%; background: radial-gradient(circle, rgba(255,255,255,0) 40%, rgba(50, 50, 255, 1) 100%); position: absolute: top: 0; left: 0; float: left;`;

            this.selectCell.append(div);
        }

        removeSelectStyle(){
            this.selectCell.innerHTML = "";
        }

    }

    var mat = new Mat1Coup("container");

</script>